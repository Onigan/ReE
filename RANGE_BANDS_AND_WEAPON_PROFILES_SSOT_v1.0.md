# RANGE_BANDS_AND_WEAPON_PROFILES_SSOT_v1.0
作成日: 2026-02-01
担当: Noah
目的: ReE(TimeCore)の「距離」を、内部座標(0.5mグリッド)で正確に扱いつつ、ミニマップ無しで面白く運用できるように、距離帯(RangeBand)と武器/魔法の適正距離をSSOT化する。

---

## 目次
1. 概要
2. 用途
3. 基本定義（グリッドとメートル換算）
4. 距離帯（RangeBand）定義
5. 密着（Contact）を“距離”ではなく“状態”として扱う
6. 表示ルール（ミニマップ無しのログ表現）
7. 武器レンジプロファイル（初期）
8. 魔法・射撃レンジプロファイル（初期）
9. 実装フック（TimeCore/ログ/判定）
10. 更新履歴

---

## 1. 概要
- 内部: 0.5mグリッド(XYZ整数)で距離を正確に管理する。
- 表示: 数値(m)は原則出さず、距離帯(至近/近/中/遠…)と状況(密着/背後/遮蔽などタグ)で“意味”を伝える。
- 目的: 武器/魔法/射撃の「適正距離」「不利距離」を、TimeCoreの時間コストと結びつけて ReEらしい読み合いを生む。

---

## 2. 用途
- 通常攻撃/スキル/魔法/射撃の射程・不利を統一ルールで扱う
- ミニマップ無しでも「詰められた」「間合いを取った」「背後を取られた」をログで理解できる
- 今後のCover/LoS/高低差/迎撃などの拡張の土台

---

## 3. 基本定義（グリッドとメートル換算）
- 1グリッド = 0.5m
- gridDist（チェスボード距離） = max(|dx|, |dz|) を基本とする（MVP）
- meterDist ≒ gridDist * 0.5

※Y(高低差)は現段階ではタグ扱い（将来拡張）

---

## 4. 距離帯（RangeBand）定義（内部ロジック用）
### RangeBand（推奨）
- BAND_CONTACT（密着帯）: 0.0m ～ 0.5m（gridDist 0～1）
- BAND_SHORT（短）: 0.5m ～ 1.0m（gridDist 1～2）
- BAND_MID（中）: 1.0m ～ 2.0m（gridDist 2～4）
- BAND_LONG（長）: 2.0m ～ 6.0m（gridDist 4～12）
- BAND_RANGED（遠）: 6.0m ～ 30m（gridDist 12～60）
- BAND_FAR（超遠）: 30m ～ 80m（gridDist 60～160）
- BAND_EXTREME（極遠）: 80m+（gridDist 160+）※狙撃/特殊魔法の領域

※この境界は “将来の調整前提” だが、武器の距離感（ナイフ0.5m等）と整合しやすい。

---

## 5. 密着（Contact）を“距離”ではなく“状態”として扱う（重要）
### なぜ状態化するか
- 「密着」は単なる距離ではなく、揉み合い/拘束/押し合い/武器が振れない等の “状況変化” を伴うため。
- ReEでは、密着を成立させることで「弓/銃/長柄が不利になる」など、読み合いの核になる。

### ContactState（例）
- ContactState.None
- ContactState.CloseBody（体が触れる至近）: 距離がCONTACT帯
- ContactState.Grapple（組み付き）: 技/状態で付与（距離に加え拘束）

### 発生例
- 奇襲で背後から押し倒す
- 体当たり/組み付き/転倒
- 狭所で押し合い（隊列崩れ）
- 盾押し（将来スキル）

---

## 6. 表示ルール（ミニマップ無しのログ表現）
### 原則
- 数値（m/グリッド）は表示しない（デバッグだけ）
- 表示は「距離帯」「相対方位」「状況タグ」を優先

### 表示語（プレイヤー向け）
- 距離帯の見せ方（例）
  - 密着 / 至近 / 近い / 少し離れている / 遠い / かなり遠い
- 相対方位（最小）
  - 正面 / 側面 / 背後
- 状況タグ（将来）
  - 遮蔽 / 視界不良 / 高低差 / 足場不安定 など

### 必須ログ（MVP）
- 行動開始時（または距離変化時）に:
  - `[Range] 近い（正面）`
- 距離帯が変化したら必ず:
  - `[Range] 近い → 至近`
- 密着（状態）が成立したら:
  - `[Contact] 絡み合う距離だ`

---

## 7. 武器レンジプロファイル（初期）
※「最適帯 / 許容帯 / 不利帯 / 不可」の順に定義する。
※“帯”は上のRangeBand名を参照。

| 武器カテゴリ | 最適帯 | 許容帯 | 不利帯 | 不可 | コメント（ReEらしさ） |
|---|---|---|---|---|---|
| ナイフ/短剣 | CONTACT/SHORT | MID | LONG以上 | RANGED以上 | 密着が強い。押し倒し/拘束と相性◎ |
| 片手剣 | SHORT | MID | CONTACT | RANGED以上 | 密着だと振りが死ぬが、完全不可ではない |
| 大剣 | MID | SHORT | CONTACT | RANGED以上 | 密着で最悪。距離管理の価値が出る |
| 槍/長柄 | LONG | MID | CONTACT/SHORT | RANGED以上 | 近づかれると本当に弱い（ただし突きは残す等も可） |
| 盾（攻撃ではなく防御/押し） | CONTACT/SHORT | MID | - | - | 将来「押し込み」「密着化」の主役 |

---

## 8. 魔法・射撃レンジプロファイル（初期）
| 種別 | 最適帯 | 許容帯 | 不利帯 | 不可 | コメント |
|---|---|---|---|---|---|
| 弓 | RANGED | FAR（状況次第） | MID以下 | CONTACT | 詰められると致命的。密着が明確なカウンター |
| 銃（短～中距離銃） | RANGED/FAR | MID | SHORT | CONTACT | 密着で奪われる/撃てない等、状態で表現しやすい |
| 狙撃（ライフル/長距離） | FAR/EXTREME | RANGED | MID以下 | SHORT/CONTACT | “準備時間”が長い代わりに極遠で強い |
| 魔法（近接術：触媒/呪印） | CONTACT/SHORT | MID | LONG以上 | FAR以上 | 触れることが条件の術。密着設計が活きる |
| 魔法（投射：火球など） | MID/LONG | SHORT～RANGED | CONTACT（詠唱妨害） | EXTREME（術次第） | 密着だと詠唱妨害/暴発リスク等で差別化 |
| 魔法（広域：雷雨/結界） | RANGED/FAR | MID～EXTREME | CONTACT（詠唱妨害） | - | 詠唱/準備が重い分、位置取りが重要になる |

---

## 9. 実装フック（TimeCore/ログ/判定）
### 判定の最小手順（MVP）
1) gridDist = CalculateGridDistance(...)
2) RangeBand = GetRangeBand(gridDist)
3) WeaponProfile の「可否/不利」を参照
4) 表示は距離帯語＋タグ（数値なし）

### TimeCoreへの結びつけ（推奨方針）
- 不利帯: 命中率やダメージではなく “時間コスト増” で表現しやすい
  - 例: 不利帯なら Prep +1tick（取り回しが悪い）
- 不可: そのまま失敗ではなく「自動移動を挿入→時間がかかる」へ寄せる（ReE向き）
  - 例: 大剣で密着 → 一歩下がる（離脱）を挟む等

### ログ例（ミニマップ無し）
- `[Range] 近い（正面）`
- `Playerは間合いを測っている…`
- `[Contact] 互いの息がかかる距離だ`
- `弓は狙いを付けられない…（距離が近すぎる）`
- `大剣は振り切れない…（密着）`

---

## 10. 更新履歴
- 2026-02-01 / Noah / 新規作成 / RANGE_BANDS_AND_WEAPON_PROFILES_SSOT_v1.0.md
